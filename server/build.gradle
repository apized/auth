plugins {
  id 'org.apized.micronaut' version "$apizedVersion"
  id 'jacoco'
}

dependencies {
  annotationProcessor 'io.micronaut.openapi:micronaut-openapi'
  implementation 'com.auth0:java-jwt:4.3.0'
}

application {
  mainClass.set("org.apized.auth")
}

tasks.named("dockerBuildNative") {
  images = [System.getenv("IMAGE_TAG") ?: "assignment:$project.version"]
}

tasks.named('dockerfileNative') {
  baseImage('frolvlad/alpine-glibc:alpine-3.14') // amd64
}

test{
  if (project.hasProperty('excludeTests')) {
    project.properties['excludeTests']?.replaceAll('\\s', '')?.split('[,;]')?.each {
      exclude "${it}"
    }
  }
}